import{r as a,R as X,j as e,c as Z,u as P,w as D,b as ee,E as se,a as re,S as _}from"./vendor-21pl5SCj.js";import{B as M}from"./examenes-laboratorio-crud-CdCrF0QH.js";function oe({initialData:r={},onRegistroExitoso:E}){const[o,w]=a.useState({id:r.id||void 0,dni:r.dni||"",nombre:r.nombre||"",apellido:r.apellido||"",historia_clinica:r.historia_clinica||"",fecha_nacimiento:r.fecha_nacimiento||"",edad:r.edad||"",edad_unidad:r.edad_unidad||"años",procedencia:r.procedencia||"",tipo_seguro:r.tipo_seguro||"",sexo:r.sexo||"M",direccion:r.direccion||"",telefono:r.telefono||"",email:r.email||""});X.useEffect(()=>{w({id:r.id||void 0,dni:r.dni||"",nombre:r.nombre||"",apellido:r.apellido||"",historia_clinica:r.historia_clinica||"",fecha_nacimiento:r.fecha_nacimiento||"",edad:r.edad||"",edad_unidad:r.edad_unidad||"años",procedencia:r.procedencia||"",tipo_seguro:r.tipo_seguro||"",sexo:r.sexo||"M",direccion:r.direccion||"",telefono:r.telefono||"",email:r.email||""})},[r]);const[N,m]=a.useState(""),[h,k]=a.useState(!1),l=d=>{w({...o,[d.target.name]:d.target.value})},y=async d=>{d.preventDefault(),k(!0),m("");try{const p=await(await fetch(M+"api_pacientes.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).json();p.success&&p.paciente?E(p.paciente):m(p.error||(o.id?"Error al actualizar paciente":"Error al registrar paciente"))}catch{m(o.id?"Error de conexión al actualizar":"Error de conexión al registrar")}k(!1)};return e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-purple-800 mb-4",children:o.id?"Editar Paciente":"Registrar Nuevo Paciente"}),e.jsxs("form",{onSubmit:y,className:"space-y-4 bg-blue-50 p-4 rounded border border-blue-200 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-300",children:[e.jsxs("h3",{className:"text-lg font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Información Básica"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"DNI *"}),e.jsx("input",{name:"dni",value:o.dni,onChange:l,placeholder:"Documento de identidad",className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Historia Clínica",e.jsx("span",{className:"text-sm text-gray-500 font-normal ml-2",children:"(Se genera automáticamente si está vacío)"})]}),e.jsx("input",{name:"historia_clinica",value:o.historia_clinica,onChange:l,placeholder:"HC##### (opcional - se genera automáticamente)",className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre *"}),e.jsx("input",{name:"nombre",value:o.nombre,onChange:l,placeholder:"Nombres del paciente",className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Apellido *"}),e.jsx("input",{name:"apellido",value:o.apellido,onChange:l,placeholder:"Apellidos del paciente",className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sexo *"}),e.jsxs("select",{name:"sexo",value:o.sexo,onChange:l,className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"M",children:"Masculino"}),e.jsx("option",{value:"F",children:"Femenino"}),e.jsx("option",{value:"Otro",children:"Otro"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-300",children:[e.jsxs("h3",{className:"text-lg font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Información de Edad"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de Nacimiento"}),e.jsx("input",{name:"fecha_nacimiento",value:o.fecha_nacimiento,onChange:l,type:"date",className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Edad"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{name:"edad",value:o.edad,onChange:l,placeholder:"Edad",type:"number",className:"flex-1 border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsxs("select",{name:"edad_unidad",value:o.edad_unidad,onChange:l,className:"border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"días",children:"Días"}),e.jsx("option",{value:"meses",children:"Meses"}),e.jsx("option",{value:"años",children:"Años"})]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-300",children:[e.jsxs("h3",{className:"text-lg font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),"Información Adicional"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Procedencia"}),e.jsx("input",{name:"procedencia",value:o.procedencia,onChange:l,placeholder:"Ciudad o lugar de procedencia",className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Seguro"}),e.jsx("input",{name:"tipo_seguro",value:o.tipo_seguro,onChange:l,placeholder:"Ej: SIS, EsSalud, Particular, etc.",className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dirección"}),e.jsx("textarea",{name:"direccion",value:o.direccion,onChange:l,placeholder:"Dirección completa del paciente",rows:"2",className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-300",children:[e.jsxs("h3",{className:"text-lg font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),"Información de Contacto"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teléfono"}),e.jsx("input",{name:"telefono",value:o.telefono,onChange:l,placeholder:"Número de contacto",type:"tel",className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{name:"email",value:o.email,onChange:l,placeholder:"Correo electrónico",type:"email",className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),N&&e.jsx("div",{className:"bg-red-50 border border-red-300 text-red-800 px-4 py-3 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),N]})}),e.jsx("div",{className:"sticky bottom-0 bg-blue-50 p-4 -mx-4 -mb-4 border-t border-blue-200",children:e.jsx("button",{type:"submit",className:"w-full bg-purple-800 hover:bg-purple-900 text-white rounded-lg px-4 py-3 font-bold text-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:h,children:h?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.id?"Actualizando...":"Registrando..."]}):o.id?"Actualizar Paciente":"Registrar Paciente"})})]})]})}function te({message:r="Cargando..."}){return e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600 mb-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),e.jsx("span",{className:"text-blue-700 font-medium text-base",children:r})]})}function ae(){const r=Z(),[E,o]=a.useState([]),[w,N]=a.useState(!0),[m,h]=a.useState(""),[k,l]=a.useState(!1),[y,d]=a.useState(null),[u,p]=a.useState("id"),[x,W]=a.useState("desc"),[C,J]=a.useState(5),[g,b]=a.useState(1),[f,H]=a.useState(""),[j,A]=a.useState(""),[L,V]=a.useState(""),S=async()=>{try{N(!0);const n=await(await fetch(M+"api_pacientes.php")).json();n.success?(o(n.pacientes),h("")):h(n.error||"Error al cargar pacientes")}catch{h("Error de conexión con el servidor")}finally{N(!1)}};a.useEffect(()=>{S()},[]);const U=async s=>{console.log("Paciente registrado/actualizado:",s),l(!1),d(null),await S(),y||b(1),console.log("Lista recargada exitosamente")},v=s=>{u===s?W(x==="asc"?"desc":"asc"):(p(s),W("asc")),b(1)},F=()=>{d({id:void 0,dni:"",nombre:"",apellido:"",historia_clinica:"",fecha_nacimiento:"",edad:"",edad_unidad:"años",procedencia:"",tipo_seguro:"",sexo:"M",direccion:"",telefono:"",email:""}),l(!0)},I=s=>{d({id:s.id,dni:s.dni||"",nombre:s.nombre||"",apellido:s.apellido||"",historia_clinica:s.historia_clinica||"",fecha_nacimiento:s.fecha_nacimiento||"",edad:s.edad||"",edad_unidad:s.edad_unidad||"años",procedencia:s.procedencia||"",tipo_seguro:s.tipo_seguro||"",sexo:s.sexo||"M",direccion:s.direccion||"",telefono:s.telefono||"",email:s.email||""}),l(!0)},$=async s=>{if((await _.fire({title:"¿Eliminar paciente?",text:"Esta acción no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{const c=await(await fetch(M+"api_pacientes.php",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:s.id})})).json();c.success?(await S(),_.fire("Eliminado","Paciente eliminado correctamente","success")):_.fire("Error",c.error||"Error al eliminar paciente","error")}catch{_.fire("Error","Error de conexión con el servidor","error")}},R=s=>{const n=`${M}descargar_caratula_paciente.php?paciente_id=${s.id}`,t=document.createElement("a");t.href=n,t.download=`caratula_${s.historia_clinica}.pdf`,document.body.appendChild(t),t.click(),document.body.removeChild(t)};let i=E.filter(s=>{const n=L.trim().toLowerCase();if(n&&!(s.historia_clinica&&s.historia_clinica.toLowerCase().includes(n)||s.nombre&&s.nombre.toLowerCase().includes(n)||s.apellido&&s.apellido.toLowerCase().includes(n)||s.dni&&s.dni.toLowerCase().includes(n)))return!1;if(!f&&!j)return!0;if(!s.creado_en)return!1;const t=s.creado_en.split(" ")[0];return!(f&&t<f||j&&t>j)});i=i.sort((s,n)=>{let t=s[u],c=n[u];return typeof t=="string"&&(t=t.toLowerCase()),typeof c=="string"&&(c=c.toLowerCase()),t==null?1:c==null?-1:t<c?x==="asc"?-1:1:t>c?x==="asc"?1:-1:0});const Y=i.length,B=Math.ceil(Y/C),T=(g-1)*C,G=T+C,z=i.slice(T,G),O=()=>{const s=P.json_to_sheet(i),n=P.book_new();P.book_append_sheet(n,s,"Pacientes");const t=D(n,{bookType:"xlsx",type:"array"}),c=new Blob([t],{type:"application/octet-stream"});ee.saveAs(c,`pacientes_${new Date().toISOString().slice(0,10)}.xlsx`)},q=()=>{const s=new se;s.text("Pacientes",14,10),re(s,{columns:[{header:"Historia Clínica",dataKey:"historia_clinica"},{header:"Nombres",dataKey:"nombre"},{header:"Apellidos",dataKey:"apellido"},{header:"Edad",dataKey:"edad"},{header:"DNI",dataKey:"dni"}],body:i,startY:18,styles:{fontSize:9},headStyles:{fillColor:[59,130,246]}}),s.save(`pacientes_${new Date().toISOString().slice(0,10)}.pdf`)},Q=s=>{J(Number(s.target.value)),b(1)},K=s=>{s>=1&&s<=B&&b(s)};return e.jsxs("div",{className:"p-4 bg-white rounded shadow",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 gap-3",children:[e.jsxs("h2",{className:"text-xl font-bold text-purple-800 flex items-center gap-2",children:[e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),"Pacientes"]}),e.jsxs("div",{className:"hidden sm:flex flex-wrap items-center gap-2",children:[e.jsxs("button",{onClick:F,className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-bold transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Agregar Paciente"]}),e.jsxs("button",{onClick:O,className:"bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded-lg font-medium transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Excel"]}),e.jsxs("button",{onClick:q,className:"bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-lg font-medium transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"PDF"]})]})]}),e.jsxs("div",{className:"sm:hidden mb-4",children:[e.jsx("div",{className:"flex gap-2 mb-3",children:e.jsxs("button",{onClick:F,className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white px-4 py-3 rounded-lg font-bold transition-colors flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Agregar Paciente"]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:O,className:"flex-1 bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded-lg font-medium transition-colors flex items-center justify-center gap-1 text-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Excel"]}),e.jsxs("button",{onClick:q,className:"flex-1 bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-lg font-medium transition-colors flex items-center justify-center gap-1 text-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"PDF"]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",value:L,onChange:s=>{V(s.target.value),b(1)},placeholder:"Buscar por historia clínica, nombre, apellido o DNI",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500"}),L&&e.jsx("button",{onClick:()=>{V(""),b(1)},className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400 hover:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filtrar por fecha de registro:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Desde"}),e.jsx("input",{type:"date",value:f,onChange:s=>H(s.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Hasta"}),e.jsx("input",{type:"date",value:j,onChange:s=>A(s.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})]}),(f||j)&&e.jsx("button",{onClick:()=>{H(""),A("")},className:"mt-2 text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Limpiar filtros de fecha"})]}),e.jsxs("div",{className:"sm:w-48",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Registros por página:"}),e.jsxs("select",{value:C,onChange:Q,className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:5,children:"5 registros"}),e.jsx("option",{value:10,children:"10 registros"}),e.jsx("option",{value:25,children:"25 registros"})]})]})]}),i.length>0&&e.jsx("div",{className:"text-sm text-gray-600 bg-white px-3 py-2 rounded-lg border border-gray-200",children:e.jsx("span",{className:"font-medium",children:L||f||j?`${i.length} resultado${i.length!==1?"s":""} encontrado${i.length!==1?"s":""}`:`${i.length} paciente${i.length!==1?"s":""} registrado${i.length!==1?"s":""}`})})]}),w?e.jsx(te,{message:"Cargando pacientes..."}):m?e.jsx("div",{className:"text-red-600",children:m}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden lg:block overflow-x-auto w-full",children:e.jsxs("table",{className:"min-w-full text-sm border",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-blue-100",children:[e.jsxs("th",{className:"px-2 py-1 border cursor-pointer",onClick:()=>v("historia_clinica"),children:["HC ",u==="historia_clinica"?x==="asc"?"▲":"▼":""]}),e.jsxs("th",{className:"px-2 py-1 border cursor-pointer",onClick:()=>v("nombre"),children:["Nombre ",u==="nombre"?x==="asc"?"▲":"▼":""]}),e.jsxs("th",{className:"px-2 py-1 border cursor-pointer",onClick:()=>v("apellido"),children:["Apellido ",u==="apellido"?x==="asc"?"▲":"▼":""]}),e.jsxs("th",{className:"px-2 py-1 border cursor-pointer",onClick:()=>v("edad"),children:["Edad ",u==="edad"?x==="asc"?"▲":"▼":""]}),e.jsxs("th",{className:"px-2 py-1 border cursor-pointer",onClick:()=>v("dni"),children:["DNI ",u==="dni"?x==="asc"?"▲":"▼":""]}),e.jsxs("th",{className:"px-2 py-1 border cursor-pointer",onClick:()=>v("tipo_seguro"),children:["Tipo de seguro ",u==="tipo_seguro"?x==="asc"?"▲":"▼":""]}),e.jsx("th",{className:"px-2 py-1 border",children:"Acciones"})]})}),e.jsx("tbody",{children:z.map(s=>e.jsxs("tr",{className:"hover:bg-blue-50",children:[e.jsx("td",{className:"border px-2 py-1",children:s.historia_clinica}),e.jsx("td",{className:"border px-2 py-1",children:s.nombre}),e.jsx("td",{className:"border px-2 py-1",children:s.apellido}),e.jsxs("td",{className:"border px-2 py-1",children:[s.edad!==null?s.edad:"-"," "]}),e.jsx("td",{className:"border px-2 py-1",children:s.dni}),e.jsx("td",{className:"border px-2 py-1",children:s.tipo_seguro||"-"}),e.jsx("td",{className:"border py-1",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>I(s),className:"bg-yellow-400 text-white px-1 py-1 rounded text-xs hover:bg-yellow-500",children:"Editar"}),e.jsx("button",{onClick:()=>$(s),className:"bg-red-500 text-white px-1 py-1 rounded text-xs hover:bg-red-600",children:"Eliminar"}),e.jsx("button",{onClick:()=>r(`/consumo-paciente/${s.id}`),className:"bg-blue-600 text-white px-1 py-1 rounded text-xs hover:bg-blue-700",title:"Ver consumo total",children:"Consumo"}),e.jsx("button",{onClick:()=>R(s),className:"bg-purple-600 text-white px-1 py-1 rounded text-xs hover:bg-purple-700",title:"Descargar carátula",children:"Carátula"})]})})]},s.id))})]})}),e.jsx("div",{className:"lg:hidden grid grid-cols-1 md:grid-cols-2 gap-4",children:z.map(s=>e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-bold text-purple-800",children:["HC: ",s.historia_clinica]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["DNI: ",s.dni]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>I(s),className:"bg-yellow-400 hover:bg-yellow-500 text-white p-2 rounded-full transition-colors",title:"Editar paciente",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>$(s),className:"bg-red-500 hover:bg-red-600 text-white p-2 rounded-full transition-colors",title:"Eliminar paciente",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx("button",{onClick:()=>r(`/consumo-paciente/${s.id}`),className:"bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-full transition-colors",title:"Ver consumo total",children:e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none"}),e.jsx("text",{x:"12",y:"16",textAnchor:"middle",fontSize:"10",fill:"currentColor",children:"C"})]})}),e.jsx("button",{onClick:()=>R(s),className:"bg-purple-600 hover:bg-purple-700 text-white p-2 rounded-full transition-colors",title:"Descargar carátula",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"font-medium text-blue-800",children:[s.nombre," ",s.apellido]}),e.jsx("span",{className:"text-sm bg-blue-100 px-2 py-1 rounded",children:s.edad!==null?`${s.edad} años`:"Edad no registrada"})]}),s.tipo_seguro&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),e.jsx("span",{className:"text-sm text-green-700 font-medium",children:s.tipo_seguro})]}),(s.telefono||s.email)&&e.jsxs("div",{className:"pt-2 border-t border-blue-200",children:[s.telefono&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),s.telefono]}),s.email&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mt-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),s.email]})]})]})]},s.id))}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 mt-6 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-600 order-2 sm:order-1",children:["Mostrando ",z.length," de ",i.length," registros"]}),e.jsxs("div",{className:"flex items-center gap-2 order-1 sm:order-2",children:[e.jsxs("button",{onClick:()=>K(g-1),disabled:g===1,className:"flex items-center gap-1 px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),e.jsx("span",{className:"hidden sm:inline",children:"Anterior"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"px-3 py-2 text-sm font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-lg",children:g}),e.jsx("span",{className:"px-2 text-sm text-gray-500",children:"de"}),e.jsx("span",{className:"px-3 py-2 text-sm font-medium text-gray-600 bg-gray-50 border border-gray-200 rounded-lg",children:B})]}),e.jsxs("button",{onClick:()=>K(g+1),disabled:g===B,className:"flex items-center gap-1 px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx("span",{className:"hidden sm:inline",children:"Siguiente"}),e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})]}),k&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>{l(!1),d(null)}}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-t-2xl sm:rounded-2xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full w-full max-h-full",children:[e.jsxs("div",{className:"bg-purple-800 px-4 py-3 sm:px-6 sm:py-4 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),y?"Editar Paciente":"Nuevo Paciente"]}),e.jsx("button",{onClick:()=>{l(!1),d(null)},className:"bg-purple-700 hover:bg-purple-600 text-white p-2 rounded-full transition-colors","aria-label":"Cerrar",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 max-h-[calc(100vh-120px)] sm:max-h-[80vh] overflow-y-auto",children:e.jsx(oe,{initialData:y||{},onRegistroExitoso:U})})]})]})})]})}export{oe as P,te as S,ae as a};
