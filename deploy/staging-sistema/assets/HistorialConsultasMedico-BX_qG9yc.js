import{r as a,u as w,j as e}from"./vendor-B5yQt2qK.js";import{B as C}from"./examenes-laboratorio-crud-BJk1fG4Z.js";function P({medicoId:n}){const[u,j]=a.useState([]),[b,i]=a.useState(!0),[d,x]=a.useState(""),[l,g]=a.useState(""),[r,N]=a.useState(3),[t,c]=a.useState(1),f=w();a.useEffect(()=>{i(!0),fetch(`${C}api_historial_consultas_medico.php?medico_id=${n}`,{credentials:"include"}).then(s=>s.json()).then(s=>{s.success?j(s.historial):x(s.error||"Error al cargar historial"),i(!1)}).catch(()=>{x("Error de conexión"),i(!1)})},[n]);const o=u.filter(s=>s.paciente_nombre.toLowerCase().includes(l.toLowerCase())||s.motivo.toLowerCase().includes(l.toLowerCase())||s.diagnostico.toLowerCase().includes(l.toLowerCase())),p=o.length,h=Math.ceil(p/r),m=(t-1)*r,y=m+r,v=o.slice(m,y);return a.useEffect(()=>{c(1)},[l,r]),e.jsxs("div",{className:"max-w-3xl mx-auto p-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Historial de Consultas"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[e.jsx("input",{type:"text",className:"border rounded p-2 w-full",placeholder:"Buscar por paciente, motivo o diagnóstico",value:l,onChange:s=>g(s.target.value)}),e.jsx("label",{className:"text-xs",children:"Filas por página:"}),e.jsxs("select",{value:r,onChange:s=>N(Number(s.target.value)),className:"border rounded p-1 text-xs",children:[e.jsx("option",{value:3,children:"3"}),e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"})]})]}),b?e.jsx("div",{children:"Cargando..."}):d?e.jsx("div",{className:"text-red-600",children:d}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full text-sm border rounded",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-blue-100",children:[e.jsx("th",{className:"px-2 py-1",children:"Fecha"}),e.jsx("th",{className:"px-2 py-1",children:"Paciente"}),e.jsx("th",{className:"px-2 py-1 hidden sm:table-cell",children:"Motivo"}),e.jsx("th",{className:"px-2 py-1 hidden md:table-cell",children:"Diagnóstico"}),e.jsx("th",{className:"px-2 py-1 hidden md:table-cell",children:"Estado"}),e.jsx("th",{className:"px-2 py-1",children:"Detalle"})]})}),e.jsx("tbody",{children:o.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-2",children:"Sin resultados"})}):v.map(s=>e.jsxs("tr",{className:"hover:bg-blue-50",children:[e.jsx("td",{className:"border px-2 py-1",children:s.fecha}),e.jsx("td",{className:"border px-2 py-1",children:s.paciente_nombre}),e.jsx("td",{className:"border px-2 py-1 hidden sm:table-cell",children:s.motivo}),e.jsx("td",{className:"border px-2 py-1 hidden md:table-cell",children:s.diagnostico}),e.jsx("td",{className:"border px-2 py-1 hidden md:table-cell",children:s.estado}),e.jsx("td",{className:"border px-2 py-1 text-center",children:e.jsx("button",{className:"text-blue-600 underline",onClick:()=>f(`/historia-clinica/${s.paciente_id}/${s.consulta_id}`),children:"Ver"})})]},s.id))})]}),p>0&&e.jsxs("div",{className:"flex justify-end items-center gap-2 mt-2",children:[e.jsx("button",{onClick:()=>c(t-1),disabled:t===1,className:"px-2 py-1 rounded bg-gray-200 disabled:opacity-50",children:"Anterior"}),e.jsxs("span",{className:"text-sm",children:["Página ",t," de ",h]}),e.jsx("button",{onClick:()=>c(t+1),disabled:t===h,className:"px-2 py-1 rounded bg-gray-200 disabled:opacity-50",children:"Siguiente"})]})]})]})}export{P as default};
