import{j as e,u as y,r,S as u,k as v,I as b}from"./vendor-B5yQt2qK.js";import{P as w}from"./PacienteListSearch-BKe_T2Or.js";import{C as P}from"./CobroModuloFinal-Vv0lAaBv.js";import{B as p}from"./examenes-laboratorio-crud-BJk1fG4Z.js";import{P as C}from"./PacienteListForm-CD51U7oR.js";function k({paciente:s}){return e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-3 mb-4",children:[e.jsx("div",{className:"font-bold text-blue-800 mb-2",children:"Paciente encontrado:"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Nombre:"})," ",s.nombre]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Apellido:"})," ",s.apellido]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"DNI:"})," ",s.dni]}),s.fecha_nacimiento&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Fecha de nacimiento:"})," ",s.fecha_nacimiento]}),s.sexo&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Sexo:"})," ",s.sexo]}),s.direccion&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Direcci√≥n:"})," ",s.direccion]}),s.telefono&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Tel√©fono:"})," ",s.telefono]}),s.email&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Email:"})," ",s.email]}),s.tipo_seguro&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Tipo de seguro:"})," ",s.tipo_seguro]})]}),e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Historia Cl√≠nica:"})," ",s.historia_clinica]}),s.edad&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Edad:"})," ",s.edad," ",s.edad_unidad||""]}),s.procedencia&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Procedencia:"})," ",s.procedencia]})]})]})]})}const S=[{key:"consulta",label:"Consulta M√©dica",icon:"üë®‚Äç‚öïÔ∏è",requiresPayment:!1},{key:"laboratorio",label:"Laboratorio",icon:"üî¨",requiresPayment:!0},{key:"farmacia",label:"Farmacia",icon:"üíä",requiresPayment:!0},{key:"rayosx",label:"Rayos X",icon:"ü©ª",requiresPayment:!0},{key:"ecografia",label:"Ecograf√≠a",icon:"ü©∫",requiresPayment:!0},{key:"operacion",label:"Operaciones/Cirug√≠as Mayores",icon:"ü©º",requiresPayment:!0},{key:"ocupacional",label:"Medicina Ocupacional",icon:"üë∑‚Äç‚öïÔ∏è",requiresPayment:!0}],E=["consulta","laboratorio","farmacia","ecografia","rayosx","ocupacional"];function _({paciente:s}){const t=y(),[o,l]=r.useState(null),[c,d]=r.useState(!1),[m,x]=r.useState([]);r.useEffect(()=>{fetch(p+"api_tarifas.php",{credentials:"include"}).then(a=>a.json()).then(a=>{if(a.success&&Array.isArray(a.tarifas)){const f=a.tarifas.filter(i=>i.activo===1&&!E.includes(i.servicio_tipo)).map(i=>({key:i.servicio_tipo+"_"+i.id,label:i.descripcion,icon:"üõ†Ô∏è",requiresPayment:!0,tarifaId:i.id}));x(f)}})},[]);const g=a=>{a.key==="consulta"?t("/agendar-consulta",{state:{pacienteId:s.id}}):a.key==="laboratorio"?t(`/cotizar-laboratorio/${s.id}`):a.key==="farmacia"?t(`/cotizar-farmacia/${s.id}`):a.key==="rayosx"?t(`/cotizar-rayosx/${s.id}`):a.key==="ecografia"?t(`/cotizar-ecografia/${s.id}`):a.key==="operacion"?t(`/cotizar-operacion/${s.id}`):a.key==="ocupacional"?u.fire({title:"P√°gina en construcci√≥n",text:"La funcionalidad de Medicina Ocupacional estar√° disponible pr√≥ximamente.",icon:"info",confirmButtonText:"OK"}):a.key==="procedimiento"?t(`/cotizar-procedimientos/${s.id}`):a.requiresPayment?(l(a),d(!0)):N(a)},n=async(a,f)=>{d(!1),u.fire({title:"üí∞ Pago Procesado",text:`Servicio de ${f.label} pagado exitosamente.`,icon:"success",confirmButtonText:"OK"})},h=()=>{d(!1),l(null)},N=async a=>{const f=JSON.parse(sessionStorage.getItem("usuario")||"{}");if(!f.id){u.fire("Error","No se pudo identificar al usuario","error");return}try{const j=await(await fetch(p+"api_atenciones.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paciente_id:s.id,usuario_id:f.id,servicio:a.key,observaciones:""})})).json();j.success?u.fire({title:"Atenci√≥n registrada",text:`Atenci√≥n registrada para ${a.label}.`,icon:"success",confirmButtonText:"OK"}):u.fire({title:"Error",text:j.error||"No se pudo registrar la atenci√≥n",icon:"error",confirmButtonText:"OK"})}catch(i){console.error("Error:",i),u.fire("Error","Error de conexi√≥n","error")}};return c&&o&&o.key!=="laboratorio"?e.jsx(P,{paciente:s,servicio:o,onCobroCompleto:n,onCancelar:h}):e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 rounded border border-blue-200",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 text-blue-800",children:["üè• Seleccionar Servicio para: ",s.nombre," ",s.apellido]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[S.map(a=>a.key==="ocupacional"?e.jsxs("button",{onClick:()=>{u.fire({title:"P√°gina en construcci√≥n",text:"La funcionalidad de Medicina Ocupacional estar√° disponible pr√≥ximamente.",icon:"info",confirmButtonText:"OK"})},className:"flex items-center justify-center gap-2 p-4 bg-white border border-blue-300 rounded-lg hover:bg-blue-100 hover:border-blue-400 transition-colors font-medium text-blue-700 hover:text-blue-800",children:[e.jsx("span",{className:"text-2xl",children:a.icon}),e.jsx("span",{children:a.label}),a.requiresPayment&&e.jsx("span",{className:"text-green-600 text-sm",children:"üí∞"})]},a.key):e.jsxs("button",{onClick:()=>g(a),className:"flex items-center justify-center gap-2 p-4 bg-white border border-blue-300 rounded-lg hover:bg-blue-100 hover:border-blue-400 transition-colors font-medium text-blue-700 hover:text-blue-800",children:[e.jsx("span",{className:"text-2xl",children:a.icon}),e.jsx("span",{children:a.label}),a.requiresPayment&&e.jsx("span",{className:"text-green-600 text-sm",children:"üí∞"})]},a.key)),e.jsxs("button",{onClick:()=>g({key:"procedimiento",label:"Procedimientos",icon:"üõ†Ô∏è",requiresPayment:!0}),className:"flex items-center justify-center gap-2 p-4 bg-white border border-orange-300 rounded-lg hover:bg-orange-100 hover:border-orange-400 transition-colors font-medium text-orange-700 hover:text-orange-800",children:[e.jsx("span",{className:"text-2xl",children:"üõ†Ô∏è"}),e.jsx("span",{children:"Procedimientos"}),e.jsx("span",{className:"text-green-600 text-sm",children:"üí∞"})]},"procedimientos")]}),e.jsx("div",{className:"mt-3 text-sm text-gray-600 text-center",children:"üí∞ = Requiere pago previo | üè• = Agendar primero, cobrar despu√©s"})]})}function H({onPacienteRegistrado:s}){const[t,o]=r.useState(null),[l,c]=r.useState(!1),d=()=>{o(null),c(!1)},m=x=>{o(x),s&&s()};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(w,{onPacienteEncontrado:o,onNoEncontrado:()=>c(!0),onNuevaBusqueda:d}),t&&e.jsxs(e.Fragment,{children:[e.jsx(k,{paciente:t}),e.jsx(_,{paciente:t})]}),l&&!t&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"mb-2 text-blue-700",children:"Paciente no encontrado. ¬øDesea registrarlo?"}),e.jsx(C,{initialData:{},onRegistroExitoso:m})]})]})}function T({usuario:s}){const[t,o]=r.useState(null),[l,c]=r.useState({pacientesHoy:0,consultasHoy:0,totalPacientes:0}),d=v(),m=r.useCallback(async()=>{try{const h=await(await fetch(p+"api_estadisticas_dashboard.php")).json();h.success?c({pacientesHoy:h.estadisticas.pacientes_hoy,consultasHoy:h.estadisticas.consultas_hoy,totalPacientes:h.estadisticas.total_pacientes}):(console.error("Error al obtener estad√≠sticas:",h.error),c({pacientesHoy:0,consultasHoy:0,totalPacientes:0}))}catch(n){console.error("Error de conexi√≥n al obtener estad√≠sticas:",n),c({pacientesHoy:0,consultasHoy:0,totalPacientes:0})}},[]),x=r.useCallback(()=>{fetch(p+"api_ultima_hc.php").then(n=>n.json()).then(n=>{n.success&&o(n.ultima_hc)}),m()},[m]);r.useEffect(()=>{x(),m()},[s,d.pathname,x,m]);const g=()=>new Intl.DateTimeFormat("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"}).format(new Date);return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 p-4 sm:p-6 lg:p-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 via-indigo-600 to-blue-600 rounded-2xl p-6 sm:p-8 text-white shadow-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-white/10 rounded-full -translate-y-20 translate-x-20"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-white/5 rounded-full translate-y-16 -translate-x-16"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"flex items-center justify-center w-16 h-16 bg-white/20 rounded-2xl backdrop-blur-sm",children:e.jsx(b,{iconName:"Hospital",className:"text-3xl text-white"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl font-bold drop-shadow-lg",children:["¬°Bienvenido, ",s?.nombre," ",s?.apellido||"","!"]}),e.jsx("p",{className:"text-lg text-white/90 mt-1",children:g()})]})]}),e.jsx("p",{className:"text-xl text-white/95 font-medium",children:"Panel de Control - Cl√≠nica 2 de Mayo"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"group bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-cyan-100 hover:border-cyan-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-gradient-to-br from-cyan-400 to-blue-500 rounded-xl",children:e.jsx(b,{iconName:"People",className:"text-2xl text-white"})}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:l.pacientesHoy}),e.jsx("p",{className:"text-sm text-gray-500",children:"Hoy"})]})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:"Pacientes Atendidos"}),e.jsx("p",{className:"text-sm text-gray-600",children:"En el d√≠a de hoy"})]}),e.jsxs("div",{className:"group bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-emerald-100 hover:border-emerald-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-gradient-to-br from-emerald-400 to-green-500 rounded-xl",children:e.jsx(b,{iconName:"Health",className:"text-2xl text-white"})}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:l.consultasHoy}),e.jsx("p",{className:"text-sm text-gray-500",children:"Hoy"})]})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:"Consultas M√©dicas"}),e.jsx("p",{className:"text-sm text-gray-600",children:"En el d√≠a de hoy"})]}),e.jsxs("div",{className:"group bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-purple-100 hover:border-purple-200 sm:col-span-2 lg:col-span-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-gradient-to-br from-purple-400 to-indigo-500 rounded-xl",children:e.jsx(b,{iconName:"Contact",className:"text-2xl text-white"})}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:l.totalPacientes}),e.jsx("p",{className:"text-sm text-gray-500",children:"Total"})]})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:"Pacientes Registrados"}),e.jsx("p",{className:"text-sm text-gray-600",children:"En la base de datos"})]})]}),t&&e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-amber-100",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-gradient-to-br from-amber-400 to-orange-500 rounded-xl",children:e.jsx(b,{iconName:"DocumentSearch",className:"text-2xl text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"√öltima Historia Cl√≠nica"}),e.jsx("p",{className:"text-gray-600",children:"Registro m√°s reciente en el sistema"})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-4 border border-amber-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-amber-100 rounded-lg",children:e.jsx(b,{iconName:"NumberField",className:"text-lg text-amber-700"})}),e.jsx("span",{className:"text-lg font-mono font-bold text-amber-800",children:t}),e.jsxs("span",{className:"text-sm text-amber-600 bg-amber-100 px-2 py-1 rounded-full",children:["HC #",t]})]})})]})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 p-6 text-white",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-white/20 rounded-xl backdrop-blur-sm",children:e.jsx(b,{iconName:"ContactCard",className:"text-2xl text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Atenci√≥n en Recepci√≥n"}),e.jsx("p",{className:"text-indigo-100",children:"Gesti√≥n de pacientes y servicios"})]})]})}),e.jsx("div",{className:"p-6",children:e.jsx(H,{onPacienteRegistrado:x})})]})]})}export{T as default};
