import{j as e,b as H,r as h,S as b}from"./vendor-B5yQt2qK.js";import{B as N}from"./examenes-laboratorio-crud-BJk1fG4Z.js";function W({tarifas:t,obtenerLabelServicio:c,abrirModal:d,eliminarTarifa:i,medicos:a}){return e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"block sm:hidden p-2",children:e.jsx("div",{className:"space-y-4",children:t.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No hay tarifas registradas para este filtro"}):t.map(s=>{const n=a&&s.medico_id?a.find(r=>r.id===parseInt(s.medico_id)):null,l=n?`Dr(a). ${[n.nombre,n.apellido].filter(Boolean).join(" ").replace(/\s+/g," ").trim()}${n.especialidad?` - ${n.especialidad}`:""}`:"General";return e.jsxs("div",{className:`rounded-xl shadow-lg border border-blue-100 bg-gradient-to-br from-blue-50 via-white to-blue-100 p-4 flex flex-col gap-2 ${s.activo!==1?"opacity-60 bg-yellow-50":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-bold text-blue-800 text-lg",children:c(s.servicio_tipo)}),s.activo!==1&&e.jsxs("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-yellow-200 text-yellow-900 flex items-center gap-1",children:[e.jsx("span",{role:"img","aria-label":"inactivo",children:"‚ö†Ô∏è"})," Inactiva"]})]}),e.jsxs("div",{className:"text-sm text-gray-700 mb-1",children:[e.jsx("span",{className:"font-bold",children:"M√©dico:"})," ",l]}),e.jsxs("div",{className:"text-sm text-gray-700 mb-1",children:[e.jsx("span",{className:"font-bold",children:"Descripci√≥n:"})," ",s.descripcion]}),e.jsxs("div",{className:"flex gap-2 text-xs text-gray-500 mb-1",children:[e.jsxs("span",{children:["Particular: ",e.jsxs("span",{className:"font-bold text-blue-800",children:["S/ ",parseFloat(s.precio_particular).toFixed(2)]})]}),s.precio_seguro&&e.jsxs("span",{children:["Seguro: ",e.jsxs("span",{className:"font-bold",children:["S/ ",parseFloat(s.precio_seguro).toFixed(2)]})]}),s.precio_convenio&&e.jsxs("span",{children:["Convenio: ",e.jsxs("span",{className:"font-bold",children:["S/ ",parseFloat(s.precio_convenio).toFixed(2)]})]})]}),e.jsxs("div",{className:"mt-2 flex gap-2 justify-end",children:[e.jsx("button",{onClick:()=>d(s),className:"p-2 rounded-full bg-blue-100 hover:bg-blue-200 text-blue-700 shadow flex items-center justify-center",title:"Editar",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536M9 13l6.293-6.293a1 1 0 011.414 0l1.586 1.586a1 1 0 010 1.414L11 15H9v-2z"})})}),e.jsx("button",{onClick:()=>i(s.id,s.descripcion),className:"p-2 rounded-full bg-red-100 hover:bg-red-200 text-red-700 shadow flex items-center justify-center",title:"Eliminar",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]},s.id)})})}),e.jsx("div",{className:"hidden sm:block",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"hidden sm:table-cell px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"M√©dico"}),e.jsx("th",{className:"px-3 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Servicio"}),e.jsx("th",{className:"hidden sm:table-cell px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Descripci√≥n"}),e.jsx("th",{className:"px-3 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Particular"}),e.jsx("th",{className:"hidden lg:table-cell px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Seguro"}),e.jsx("th",{className:"hidden lg:table-cell px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Convenio"}),e.jsx("th",{className:"px-3 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(s=>e.jsxs("tr",{className:`hover:bg-gray-50 transition-all ${s.activo!==1?"opacity-60 bg-yellow-50":""}`,children:[e.jsx("td",{className:"hidden sm:table-cell px-6 py-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:(()=>{const n=a&&s.medico_id?a.find(l=>l.id===parseInt(s.medico_id)):null;if(n){const l=[n.nombre,n.apellido].filter(Boolean).join(" ").replace(/\s+/g," ").trim(),r=n.especialidad?` - ${n.especialidad}`:"";return`Dr(a). ${l}${r}`}return"General"})()})}),e.jsx("td",{className:"px-3 md:px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"flex items-center mb-1 sm:mb-0",children:[e.jsx("span",{className:"text-lg mr-2",children:"üè•"}),e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:c(s.servicio_tipo)}),s.activo!==1&&e.jsxs("span",{className:"ml-2 px-2 py-0.5 rounded-full text-xs font-semibold bg-yellow-200 text-yellow-900 flex items-center gap-1",children:[e.jsx("span",{role:"img","aria-label":"inactivo",children:"‚ö†Ô∏è"})," Inactiva"]})]}),e.jsx("div",{className:"sm:hidden mt-2 text-sm font-medium text-gray-900",children:s.descripcion})]})}),e.jsx("td",{className:"hidden sm:table-cell px-6 py-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.descripcion})}),e.jsxs("td",{className:"px-3 md:px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.jsxs("div",{className:"font-medium",children:["S/ ",parseFloat(s.precio_particular).toFixed(2)]}),e.jsxs("div",{className:"block lg:hidden text-xs text-gray-500 mt-1",children:[s.precio_seguro&&e.jsxs("div",{children:["Seguro: S/ ",parseFloat(s.precio_seguro).toFixed(2)]}),s.precio_convenio&&e.jsxs("div",{children:["Convenio: S/ ",parseFloat(s.precio_convenio).toFixed(2)]})]})]}),e.jsx("td",{className:"hidden lg:table-cell px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.precio_seguro?`S/ ${parseFloat(s.precio_seguro).toFixed(2)}`:"-"}),e.jsx("td",{className:"hidden lg:table-cell px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.precio_convenio?`S/ ${parseFloat(s.precio_convenio).toFixed(2)}`:"-"}),e.jsx("td",{className:"px-3 md:px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-2 space-y-1 sm:space-y-0",children:e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-1 sm:space-y-0 sm:space-x-2",children:[e.jsx("button",{onClick:()=>d(s),className:"text-blue-600 hover:text-blue-900 px-2 py-1 bg-blue-100 rounded text-xs sm:text-sm",children:"‚úèÔ∏è Editar"}),e.jsx("button",{onClick:()=>i(s.id,s.descripcion),className:"text-red-600 hover:text-red-900 px-2 py-1 bg-red-100 rounded text-xs sm:text-sm",children:"üóëÔ∏è Eliminar"})]})})})]},s.id))})]})})})]})}function X({mostrar:t,cerrarModal:c,tarifaEditando:d,nuevaTarifa:i,setNuevaTarifa:a,medicos:s,serviciosMedicos:n,generarDescripcion:l,guardarTarifa:r}){return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-4 sm:p-10 w-full max-w-3xl mx-2 sm:mx-4 overflow-y-auto",style:{maxHeight:"95vh"},children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:d?"Editar Tarifa":"Nueva Tarifa"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Servicio *"}),e.jsx("select",{value:i.servicio_tipo,onChange:o=>a({...i,servicio_tipo:o.target.value}),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:n.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["M√©dico * ",s.length===0&&e.jsx("span",{className:"text-gray-400",children:"(Cargando...)"})]}),e.jsxs("select",{value:i.medico_id,onChange:o=>{const g=o.target.value;a({...i,medico_id:g})},className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:s.length===0,children:[e.jsx("option",{value:"general",children:"Tarifa General (Todos los m√©dicos)"}),s.map(o=>e.jsxs("option",{value:o.id,children:["Dr(a). ",o.nombre," ",o.apellido||""," - ",o.especialidad||"General"]},o.id))]}),s.length===0&&e.jsx("div",{className:"text-sm text-orange-600 mt-1",children:"‚ö†Ô∏è No se pudieron cargar los m√©dicos. Verifique la conexi√≥n."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripci√≥n del Servicio *"}),e.jsx("input",{type:"text",value:i.descripcion,onChange:o=>a({...i,descripcion:o.target.value}),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: RX de t√≥rax, Ecograf√≠a abdominal, Consulta pedi√°trica, etc."}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Solo ingresa el nombre del servicio, sin nombre ni especialidad del m√©dico."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio Particular * (S/)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:i.precio_particular,onChange:o=>a({...i,precio_particular:o.target.value}),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"% para M√©dico"}),e.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:i.porcentaje_medico,onChange:o=>a({...i,porcentaje_medico:o.target.value}),className:"w-full border rounded px-3 py-2 bg-gray-100 cursor-not-allowed",placeholder:"Deshabilitado ‚Äî usar Monto fijo para M√©dico",disabled:!0}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:'Deshabilitado: usa "Monto fijo para M√©dico" en su lugar.'})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"% para Cl√≠nica"}),e.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:i.porcentaje_clinica,onChange:o=>a({...i,porcentaje_clinica:o.target.value}),className:"w-full border rounded px-3 py-2 bg-gray-100 cursor-not-allowed",placeholder:"Deshabilitado ‚Äî usar Monto fijo para Cl√≠nica",disabled:!0}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:'Deshabilitado: usa "Monto fijo para Cl√≠nica" en su lugar.'})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto fijo para M√©dico (S/)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:i.monto_medico,onChange:o=>a({...i,monto_medico:o.target.value}),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: 50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto fijo para Cl√≠nica (S/)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:i.monto_clinica,onChange:o=>a({...i,monto_clinica:o.target.value}),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: 30"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio Seguro (S/) - Opcional"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:i.precio_seguro,onChange:o=>a({...i,precio_seguro:o.target.value}),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio Convenio (S/) - Opcional"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:i.precio_convenio,onChange:o=>a({...i,precio_convenio:o.target.value}),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-4 mt-6",children:[e.jsx("button",{onClick:c,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50",children:"Cancelar"}),e.jsx("button",{onClick:r,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:d?"Actualizar":"Crear"})]})]})}):null}function q({paginaActual:t,totalPaginas:c,cambiarPagina:d,elementosPorPagina:i,cambiarElementosPorPagina:a}){return H.useEffect(()=>{i!==3&&a(3)},[]),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{className:"font-medium text-gray-700 text-sm sm:text-base",children:"Elementos por p√°gina:"}),e.jsxs("select",{value:i,onChange:s=>a(parseInt(s.target.value)),className:"border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[e.jsx("option",{value:3,children:"3"}),e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"})]})]}),c>1&&e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 overflow-x-auto",children:[e.jsxs("button",{onClick:()=>d(1),disabled:t===1,className:"px-2 sm:px-3 py-1 text-xs sm:text-sm border rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100 whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:"Primera"}),e.jsx("span",{className:"sm:hidden",children:"‚ùÆ‚ùÆ"})]}),e.jsxs("button",{onClick:()=>d(t-1),disabled:t===1,className:"px-2 sm:px-3 py-1 text-xs sm:text-sm border rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:[e.jsx("span",{className:"hidden sm:inline",children:"Anterior"}),e.jsx("span",{className:"sm:hidden",children:"‚ùÆ"})]}),e.jsx("div",{className:"hidden sm:flex items-center gap-2",children:Array.from({length:Math.min(5,c)},(s,n)=>{let l;return c<=5?l=n+1:l=Math.max(1,Math.min(t-2,c-4))+n,e.jsx("button",{onClick:()=>d(l),className:`px-3 py-1 text-sm border rounded ${t===l?"bg-blue-500 text-white":"hover:bg-gray-100"}`,children:l},l)})}),e.jsx("div",{className:"flex sm:hidden items-center gap-1",children:Array.from({length:Math.min(3,c)},(s,n)=>{let l;return c<=3?l=n+1:l=Math.max(1,Math.min(t-1,c-2))+n,e.jsx("button",{onClick:()=>d(l),className:`px-2 py-1 text-xs border rounded ${t===l?"bg-blue-500 text-white":"hover:bg-gray-100"}`,children:l},`mobile-${l}`)})}),e.jsxs("button",{onClick:()=>d(t+1),disabled:t===c,className:"px-2 sm:px-3 py-1 text-xs sm:text-sm border rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100",children:[e.jsx("span",{className:"hidden sm:inline",children:"Siguiente"}),e.jsx("span",{className:"sm:hidden",children:"‚ùØ"})]}),e.jsxs("button",{onClick:()=>d(c),disabled:t===c,className:"px-2 sm:px-3 py-1 text-xs sm:text-sm border rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100 whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:"√öltima"}),e.jsx("span",{className:"sm:hidden",children:"‚ùØ‚ùØ"})]})]})]})})}function A({filtroServicio:t,setFiltroServicio:c,todosLosServicios:d,totalElementos:i,paginaActual:a,totalPaginas:s,filtroMedico:n,setFiltroMedico:l}){return e.jsx("div",{className:"bg-white p-4 rounded-lg shadow mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{className:"font-medium text-gray-700",children:"Filtrar por servicio:"}),e.jsxs("select",{value:t,onChange:r=>c(r.target.value),className:"border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"todos",children:"Todos los servicios"}),d.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{htmlFor:"filtro-medico",className:"font-medium text-gray-700",children:"Buscar por m√©dico:"}),e.jsx("input",{id:"filtro-medico",type:"text",value:n,onChange:r=>l(r.target.value),placeholder:"Nombre o apellido del m√©dico",className:"border rounded px-3 py-2 w-48 text-base"})]}),e.jsxs("span",{className:"text-gray-600",children:["(",i," tarifa",i!==1?"s":""," - P√°gina ",a," de ",s,")"]})]})})}function K(){const[t,c]=h.useState([]),[d,i]=h.useState([]),[a,s]=h.useState(!0);h.useEffect(()=>{n(),l()},[]);const n=async()=>{try{s(!0);const o=await(await fetch(`${N}api_tarifas.php`,{credentials:"include"})).json();o.success&&c(o.tarifas||[])}catch{c([])}finally{s(!1)}},l=async()=>{try{const o=await(await fetch(`${N}api_medicos.php`)).json();if(o.success){const g=(o.medicos||[]).map(x=>({...x,id:parseInt(x.id)}));i(g)}}catch{i([])}};return{tarifas:t,medicos:d,loading:a,cargarTarifas:n}}function V(t,c=5){const[d,i]=h.useState(1),[a,s]=h.useState(c),n=Math.ceil(t/a),l=(d-1)*a,r=l+a;return{paginaActual:d,elementosPorPagina:a,totalPaginas:n,indiceInicio:l,indiceFin:r,cambiarPagina:x=>i(x),cambiarElementosPorPagina:x=>{s(x),i(1)},setPaginaActual:i}}function Q(){const[t,c]=h.useState(""),[d,i]=h.useState("todos");return{filtroMedico:t,setFiltroMedico:c,filtroServicio:d,setFiltroServicio:i}}function Y(t,c,d,i){return{guardarTarifa:async(l,r)=>{if(!l.descripcion.trim()){b.fire("Error","La descripci√≥n es obligatoria","error");return}if(!l.precio_particular||parseFloat(l.precio_particular)<=0){b.fire("Error","El precio particular debe ser mayor a 0","error");return}try{const o=N+"api_tarifas.php",g=r?"PUT":"POST",m={...r?{...l,id:r.id,servicio_tipo:l.servicio_tipo||r.servicio_tipo}:l};(m.porcentaje_medico===""||m.porcentaje_medico===null)&&(m.porcentaje_medico=null),(m.porcentaje_clinica===""||m.porcentaje_clinica===null)&&(m.porcentaje_clinica=null);const y=await(await fetch(o,{method:g,headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(m)})).json();y.success?(b.fire({title:"¬°√âxito!",text:r?"Tarifa actualizada correctamente":"Tarifa creada correctamente",icon:"success",confirmButtonText:"OK"}),i(!1),d(null),c({servicio_tipo:"consulta",medico_id:"general",descripcion:"",precio_particular:"",precio_seguro:"",precio_convenio:"",activo:1,porcentaje_medico:"",porcentaje_clinica:"",monto_medico:"",monto_clinica:""}),t()):b.fire("Error",y.error||"Error al guardar la tarifa","error")}catch{b.fire("Error","Error de conexi√≥n","error")}},eliminarTarifa:async(l,r)=>{if((await b.fire({title:"¬øEst√°s seguro?",text:`¬øDeseas eliminar la tarifa "${r}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"S√≠, eliminar",cancelButtonText:"Cancelar",confirmButtonColor:"#d33"})).isConfirmed)try{const g=N+"api_tarifas.php",m=await(await fetch(g,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({id:l})})).json();m.success?(b.fire("¬°Eliminado!","La tarifa ha sido eliminada","success"),t()):b.fire("Error",m.error||"Error al eliminar la tarifa","error")}catch{b.fire("Error","Error de conexi√≥n","error")}},cambiarEstado:async(l,r)=>{try{const o=N+"api_tarifas.php",x=await(await fetch(o,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({id:l,activo:r})})).json();x.success?t():b.fire("Error",x.error||"Error al cambiar estado","error")}catch{b.fire("Error","Error de conexi√≥n","error")}}}}function Z(){const[t,c]=h.useState(!1),[d,i]=h.useState(null),[a,s]=h.useState({servicio_tipo:"consulta",medico_id:"general",descripcion:"",precio_particular:"",precio_seguro:"",precio_convenio:"",activo:1,porcentaje_medico:"",porcentaje_clinica:"",monto_medico:"",monto_clinica:""});return{mostrarModal:t,setMostrarModal:c,tarifaEditando:d,setTarifaEditando:i,nuevaTarifa:a,setNuevaTarifa:s,abrirModal:(r=null)=>{r?(i(r),s({servicio_tipo:r.servicio_tipo,medico_id:r.medico_id?r.medico_id.toString():"general",descripcion:r.descripcion,precio_particular:r.precio_particular,precio_seguro:r.precio_seguro||"",precio_convenio:r.precio_convenio||"",activo:r.activo,porcentaje_medico:r.porcentaje_medico||"",porcentaje_clinica:r.porcentaje_clinica||"",monto_medico:r.monto_medico||"",monto_clinica:r.monto_clinica||""})):(i(null),s({servicio_tipo:"consulta",medico_id:"general",descripcion:"",precio_particular:"",precio_seguro:"",precio_convenio:"",activo:1,porcentaje_medico:"",porcentaje_clinica:"",monto_medico:"",monto_clinica:""})),c(!0)},cerrarModal:()=>{c(!1),i(null),s({servicio_tipo:"consulta",medico_id:"general",descripcion:"",precio_particular:"",precio_seguro:"",precio_convenio:"",activo:1,porcentaje_medico:"",porcentaje_clinica:"",monto_medico:"",monto_clinica:""})}}}function F(t,c){if(!t||t.id==="general"||t.id==="")return c||"Consulta General";const d=t.nombre,i=t.especialidad?` - ${t.especialidad}`:"";let a=c||"Consulta",s="^(Dr(a).\\s*)?"+d;t.especialidad&&(s+="(\\s*-\\s*"+t.especialidad+")?"),s+="\\s*-\\s*";const n=new RegExp(s,"i");return a=a.replace(n,"").trim(),`${d}${i} - ${a}`.replace(/ - $/,"")}const w=[{value:"consulta",label:"Consultas M√©dicas"},{value:"rayosx",label:"Rayos X"},{value:"ecografia",label:"Ecograf√≠a"},{value:"operacion",label:"Operaciones/Cirug√≠as Mayores"},{value:"ocupacional",label:"Medicina Ocupacional"},{value:"procedimientos",label:"Procedimientos M√©dicos"},{value:"cirugias",label:"Cirug√≠as Menores"},{value:"tratamientos",label:"Tratamientos Especializados"},{value:"emergencias",label:"Emergencias"}],$=[...w];function re(){const{tarifas:t,medicos:c,loading:d,cargarTarifas:i}=K(),{filtroMedico:a,setFiltroMedico:s,filtroServicio:n,setFiltroServicio:l}=Q(),{mostrarModal:r,setMostrarModal:o,tarifaEditando:g,setTarifaEditando:x,nuevaTarifa:m,setNuevaTarifa:v,abrirModal:y,cerrarModal:D}=Z(),{guardarTarifa:P,eliminarTarifa:L}=Y(i,v,x,o),B=w.map(p=>p.value);let f=t.filter(p=>B.includes(p.servicio_tipo));if(n!=="todos"&&(f=f.filter(p=>p.servicio_tipo===n)),a.trim()){const p=a.trim().toLowerCase();f=f.filter(j=>{const u=c.find(U=>Number(U.id)===Number(j.medico_id));if(!u)return!1;const _=(u.nombres||u.nombre||"").toLowerCase(),k=(u.apellidos||u.apellido||"").toLowerCase();return`${_} ${k}`.trim().includes(p)||_.includes(p)||k.includes(p)})}const C=f.length,{paginaActual:M,elementosPorPagina:G,totalPaginas:S,indiceInicio:I,indiceFin:T,cambiarPagina:O,cambiarElementosPorPagina:z,setPaginaActual:E}=V(C),R=f.slice(I,T);h.useEffect(()=>{E(1)},[n,E]),h.useEffect(()=>{if(c.length>0&&m.medico_id&&m.descripcion_base){const p=c.find(u=>u.id===parseInt(m.medico_id)),j=F(p,m.descripcion_base);v(u=>({...u,descripcion:j}))}},[c,m.medico_id,m.descripcion_base,v]);const J=p=>{const j=$.find(u=>u.value===p);return j?j.label:p};return d?e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"text-xl",children:"Cargando tarifas..."})}):e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-blue-800",children:"üí∞ Gesti√≥n de Tarifas"}),e.jsx("button",{onClick:()=>y(),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium",children:"‚ûï Nueva Tarifa"})]}),e.jsx(A,{filtroServicio:n,setFiltroServicio:l,todosLosServicios:$,totalElementos:C,paginaActual:M,totalPaginas:S,filtroMedico:a,setFiltroMedico:s}),e.jsx(q,{paginaActual:M,totalPaginas:S,cambiarPagina:O,elementosPorPagina:G,cambiarElementosPorPagina:z}),e.jsx(W,{tarifas:R,obtenerLabelServicio:J,abrirModal:y,eliminarTarifa:L,medicos:c}),e.jsx(X,{mostrar:r,cerrarModal:D,tarifaEditando:g,nuevaTarifa:m,setNuevaTarifa:v,serviciosMedicos:w,medicos:c,generarDescripcion:(p,j)=>{const u=c.find(_=>Number(_.id)===Number(p));return F(u,j)},guardarTarifa:()=>P(m,g)})]})}export{re as default};
